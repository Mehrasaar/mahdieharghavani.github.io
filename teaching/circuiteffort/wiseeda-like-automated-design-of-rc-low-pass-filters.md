---
layout: persian
classes: wide rtl-layout
dir: rtl
title: طراحی خودکار فیلتر RC پایین‌گذر با الهام از WiseEDA
permalink: /teaching/circuiteffort/wiseeda-like-automated-design-of-rc-low-pass-filters/
author_profile: true
header:
  overlay_filter: 0.3
  overlay_color: "#5e616c"
  caption: "Photo credit: [**Unsplash**](https://unsplash.com)"
---

# طراحی خودکار فیلتر RC پایین‌گذر با الهام از WiseEDA

---

## اطلاعات نویسنده

<p><strong>نام: </strong>مهدی حسینی</p> <p><strong>وابستگی:</strong> گروه مهندسی کامپیوتر، دانشگاه فردوسی مشهد</p> <p><strong>ایمیل:</strong> mahdihossaini3@gmail.com</p>



## 1. مقدمه

طراحی مدارهای آنالوگ همواره یکی از بخش‌های چالش‌برانگیز مهندسی برق بوده است. حتی برای مدارهای به‌ظاهر ساده‌ای مانند فیلترهای RC پایین‌گذر، طراح ناچار است میان چندین معیار متضاد از جمله فرکانس قطع، میزان تضعیف در باند توقف، افت بهره در باند عبور، تعداد طبقات، و محدودیت‌های عملی قطعات واقعی توازن برقرار کند. در روش‌های کلاسیک، این فرآیند اغلب مبتنی بر روابط تحلیلی ساده یا تجربه شخصی طراح انجام می‌شود که علاوه بر زمان‌بر بودن، به‌سختی قابل تعمیم و خودکارسازی است.

با پیشرفت ابزارهای طراحی به کمک کامپیوتر (EDA) و افزایش توان محاسباتی، رویکردهای مبتنی بر شبیه‌سازی عددی و بهینه‌سازی جایگاه ویژه‌ای در طراحی مدار پیدا کرده‌اند. در این میان، ظهور مدل‌های زبانی بزرگ (LLM) امکان جدیدی را فراهم کرده است: تبدیل مستقیم خواسته‌ی سطح‌بالای کاربر، که ممکن است به زبان طبیعی بیان شود، به یک طراحی مهندسی معتبر. چارچوب WiseEDA یکی از نمونه‌های شاخص این دیدگاه است که نشان می‌دهد چگونه می‌توان با ترکیب LLM، شبیه‌سازی SPICE و بهینه‌سازی حلقه‌بسته، فرآیند طراحی مدار را تا حد زیادی خودکار کرد.

پروژه حاضر با الهام از این ایده، یک سیستم مستقل و ساده‌شده برای طراحی خودکار فیلتر RC پایین‌گذر ارائه می‌دهد. هدف اصلی این پروژه، پیاده‌سازی مفاهیم کلیدی WiseEDA در مقیاسی محدود و آموزشی است، به‌گونه‌ای که هم معماری کلی سیستم‌های EDA مدرن را نشان دهد و هم به‌صورت عملی قابل پیاده‌سازی و تحلیل در سطح دانشگاه باشد.

---

## 2. مروری بر چارچوب WiseEDA

ا WiseEDA یک چارچوب طراحی مدار مبتنی بر هوش مصنوعی است که مسئله طراحی را نه به‌عنوان یک محاسبه مستقیم، بلکه به‌عنوان یک فرآیند تکرارشونده و حلقه‌بسته در نظر می‌گیرد. در این چارچوب، نقطه شروع طراحی، خواسته یا نیت کاربر (Design Intent) است که می‌تواند به صورت مشخصات عددی یا حتی متن آزاد بیان شود. این نیت توسط یک مدل زبانی تفسیر شده و به مجموعه‌ای از مشخصات فنی قابل استفاده برای سیستم تبدیل می‌شود.

پس از مرحله تفسیر، WiseEDA فضای طراحی را تعریف می‌کند؛ فضایی که شامل توپولوژی‌های ممکن، پارامترهای قابل تنظیم و محدودیت‌های طراحی است. در ادامه، مدار پیشنهادی به صورت یک netlist تولید شده و با استفاده از شبیه‌سازی SPICE ارزیابی می‌شود. نتایج شبیه‌سازی به شاخص‌های کمی تبدیل شده و در قالب یک تابع هزینه یا امتیازدهی مورد استفاده قرار می‌گیرند. الگوریتم‌های بهینه‌سازی، با استفاده از این بازخورد، پارامترهای مدار را اصلاح کرده و این چرخه تا رسیدن به پاسخ مطلوب تکرار می‌شود.

نکته کلیدی در WiseEDA نقش فعال LLM است. در این چارچوب، LLM تنها یک مفسر زبان طبیعی نیست، بلکه می‌تواند در انتخاب توپولوژی، تحلیل نتایج نامطلوب و پیشنهاد اصلاحات طراحی مشارکت کند. به همین دلیل، WiseEDA را می‌توان نمونه‌ای از هم‌گرایی هوش مصنوعی نمادین، شبیه‌سازی عددی و بهینه‌سازی مهندسی دانست.

<div style="display: flex; justify-content: center; align-items: center; gap: 10px;">
    <img src="./assets/circuiteffort/wiseEDA-photos/Fig1_wiseEDA.png" alt="Figure 1 – Closed-loop optimization framework used in WiseEDA" style="width: 300px; object-fit: contain;"></div>
<div class="caption" style="text-align: center; margin-top: 8px; direction: rtl;">Figure 1 – Closed-loop optimization framework used in WiseEDA</div>

---

## 3. هدف و دامنه پروژه حاضر

پروژه حاضر با الهام مستقیم از معماری WiseEDA طراحی شده است، اما دامنه آن به‌صورت آگاهانه محدود شده است. تمرکز پروژه صرفاً بر طراحی فیلترهای RC پایین‌گذر قرار داده شده و از پرداختن به مدارهای پیچیده آنالوگ یا RF صرف‌نظر شده است. این محدودسازی چند هدف اصلی را دنبال می‌کند:

1. ساختار سیستم قابل فهم و قابل پیاده‌سازی باقی بماند
2. نقش هر ماژول به صورت شفاف قابل تحلیل باشد
3. پروژه برای استفاده در قالب یک پروژه دانشگاهی مناسب باشد

بنابراین، این پروژه نه به‌عنوان جایگزینی برای WiseEDA، بلکه به‌عنوان یک نمونه آموزشی «WiseEDA-like» در نظر گرفته می‌شود که ایده‌های اصلی آن را در یک مسئله محدود و قابل کنترل پیاده‌سازی می‌کند.

---

## 4. شبیه‌سازی و بهینه‌سازی حلقه‌بسته

یکی از مفاهیم محوری در WiseEDA و همچنین در پروژه حاضر، استفاده از شبیه‌سازی واقعی مدار درون یک حلقه بهینه‌سازی است. برخلاف روش‌های تحلیلی کلاسیک که پاسخ مدار را با تقریب‌های ریاضی به‌دست می‌آورند، در این رویکرد از شبیه‌سازی SPICE به‌عنوان مرجع رفتار واقعی مدار استفاده می‌شود.

در این پروژه، شبیه‌سازی AC مدار با استفاده از ngspice انجام می‌شود. خروجی شبیه‌سازی شامل پاسخ فرکانسی مدار است که به‌طور مستقیم با مشخصات مورد نظر کاربر مقایسه می‌شود. این مقایسه به یک معیار عددی یا امتیاز تبدیل می‌شود که نشان‌دهنده کیفیت طراحی است.

الگوریتم بهینه‌سازی PSO با استفاده از این امتیاز، پارامترهای مدار را اصلاح می‌کند. این فرآیند به‌صورت تکرارشونده ادامه می‌یابد و هر بار اطلاعات حاصل از شبیه‌سازی به تصمیمات بعدی الگوریتم بهینه‌سازی بازخورد داده می‌شود. این ساختار حلقه‌بسته، هسته اصلی سیستم را تشکیل می‌دهد و همان مفهومی است که در WiseEDA نیز نقش محوری دارد.

<div style="display: flex; justify-content: center; align-items: center; gap: 10px;">
    <img src="./assets/circuiteffort/wiseEDA-photos/Fig2_wiseEDA.png" alt="Figure 2 – LLM-assisted automated circuit design flow in WiseEDA" style="width: 300px; object-fit: contain;"></div>
<div class="caption" style="text-align: center; margin-top: 8px; direction: rtl;">Figure 2 – LLM-assisted automated circuit design flow in WiseEDA</div>

---

## 5. معماری کلی سیستم

معماری سیستم به‌صورت ماژولار طراحی شده است تا هر بخش وظیفه مشخص و مستقلی داشته باشد و در عین حال، کل سیستم به‌صورت یکپارچه عمل کند. این معماری امکان توسعه و تغییر هر بخش را بدون تأثیر جدی بر سایر بخش‌ها فراهم می‌کند.

### 5.1 رابط کاربری (Frontend)

رابط کاربری به‌عنوان نقطه تماس کاربر با سیستم طراحی شده است. این بخش به‌صورت یک Wizard مرحله‌به‌مرحله عمل می‌کند تا کاربر بتواند مشخصات فیلتر مورد نظر خود را به‌صورت عددی یا حتی متن آزاد وارد کند. هدف اصلی این طراحی، کاهش خطاهای ورودی و ساده‌سازی تعامل کاربر با سیستم است.

<div style="display: flex; justify-content: center; align-items: center; gap: 10px;">
    <img src="./assets/circuiteffort/wiseEDA-photos/Fig3_wiseEDA.png" alt="Fig 3 - Input Specification" style="width: 300px; object-fit: contain;"></div>
<div class="caption" style="text-align: center; margin-top: 8px; direction: rtl;">Fig 3 - Input Specification</div>

### 5.2 تحلیل درخواست کاربر

پس از دریافت ورودی، ماژول Parser وظیفه دارد اطلاعات کلیدی را از درخواست کاربر استخراج کرده و آن را به یک ساختار داده‌ای منظم تبدیل کند. در کنار Parser، یک لایه سبک مبتنی بر LLM برای تفسیر متن آزاد به کار گرفته شده است. در این پروژه، LLM نقش راهنما و مفسر را دارد و تصمیمات اصلی طراحی به‌صورت الگوریتمی انجام می‌شوند.

### 5.3 انتخاب توپولوژی مدار

بر اساس مشخصات استخراج‌شده، سیستم توپولوژی مناسب مدار را انتخاب می‌کند. در این پروژه، توپولوژی‌های مختلفی از فیلتر RC آبشاری در نظر گرفته شده‌اند که هرکدام سطح متفاوتی از آزادی طراحی و پیچیدگی محاسباتی دارند. این انتخاب تأثیر مستقیمی بر فضای جستجوی الگوریتم بهینه‌سازی دارد

<div style="display: flex; justify-content: center; align-items: center; gap: 10px;">
    <img src="./assets/circuiteffort/wiseEDA-photos/Fig4_wiseEDA.png" alt="Fig 4 - Topology Selection" style="width: 300px; object-fit: contain;"></div>
<div class="caption" style="text-align: center; margin-top: 8px; direction: rtl;">Fig 4 - Topology Selection</div>

### 5.4 تولید Netlist

پس از تعیین توپولوژی و مقادیر اولیه قطعات، netlist مدار به‌صورت خودکار تولید می‌شود. این netlist شامل تعریف المان‌ها، منابع و دستورات شبیه‌سازی است و مستقیماً توسط ngspice مورد استفاده قرار می‌گیرد. ساختار Netlist به‌گونه‌ای تولید می‌شود که پارامترهای بهینه‌سازی‌شده به‌راحتی قابل جایگزینی باشند.

### 5.5 شبیه‌سازی با ngspice

ماژول ngspice وظیفه اجرای شبیه‌سازی AC مدار و استخراج پاسخ فرکانسی را بر عهده دارد. استفاده از ngspice به‌عنوان یک شبیه‌ساز استاندارد و متن‌باز، اعتبار نتایج به‌دست‌آمده را تضمین می‌کند.

### 5.6 ارزیابی پاسخ فرکانسی (Scoring)

در این مرحله، پاسخ فرکانسی مدار با مشخصات مورد نظر کاربر مقایسه می‌شود. معیارهایی مانند افت باند عبور و میزان تضعیف باند توقف در قالب یک تابع امتیازدهی عددی بیان می‌شوند. این امتیاز، مبنای تصمیم‌گیری الگوریتم بهینه‌سازی است.

### 5.7 بهینه‌سازی با PSO

الگوریتم PSO (Particle Swarm Optimization) برای جستجوی فضای پارامترهای مدار مورد استفاده قرار گرفته است. این الگوریتم به دلیل عدم نیاز به مشتق تابع هزینه و توانایی کار در فضاهای غیرخطی، گزینه مناسبی برای این مسئله محسوب می‌شود. PSO با استفاده از سرعت و موقعیت ذرات در فضای جستجو، پارامترهای ( R ) و ( C ) را به‌گونه‌ای تنظیم می‌کند که تابع هزینه به حداقل برسد.

<div style="display: flex; justify-content: center; align-items: center; gap: 10px;">
    <img src="./assets/circuiteffort/wiseEDA-photos/Fig5_wiseEDA.png" alt="Fig 5 - Optimizer Settings" style="width: 300px; object-fit: contain;"></div>
<div class="caption" style="text-align: center; margin-top: 8px; direction: rtl;">Fig 5 - Optimizer Settings</div>

### 5.8 حلقه بهینه‌سازی

تمام مراحل فوق در قالب یک حلقه بهینه‌سازی تکرارشونده اجرا می‌شوند. این حلقه شامل تولید مدار، شبیه‌سازی، ارزیابی و به‌روزرسانی پارامترها است و تا رسیدن به بهترین پاسخ ممکن ادامه می‌یابد. این تکرار تضمین می‌کند که طراحی نهایی به مشخصات تعریف‌شده نزدیک‌ترین باشد.

### 5.9 نتایج و خروجی‌ها

در نهایت، سیستم بهترین مدار به‌دست‌آمده، نمودار پاسخ فرکانسی و مقادیر نهایی قطعات را به کاربر نمایش می‌دهد. همچنین در صورت عدم تحقق کامل مشخصات، هشدارهای لازم ارائه می‌شود.

<div style="display: flex; justify-content: center; align-items: center; gap: 10px;">
    <img src="./assets/circuiteffort/wiseEDA-photos/Fig6_wiseEDA.png" alt="Fig 6 - Results" style="width: 300px; object-fit: contain;"></div>
<div class="caption" style="text-align: center; margin-top: 8px; direction: rtl;">Fig 6 - Results</div>

---

## 6. تفاوت‌های کلیدی با WiseEDA

اگرچه پروژه حاضر از نظر معماری کلی به WiseEDA شباهت دارد، تفاوت‌های مهمی نیز میان آن‌ها وجود دارد. WiseEDA برای طراحی مدارهای پیچیده RF با فضای طراحی بسیار بزرگ توسعه یافته است، در حالی که پروژه حاضر تنها بر یک کلاس خاص از مدارها تمرکز دارد. همچنین نقش LLM در WiseEDA بسیار پررنگ‌تر است و در تصمیم‌گیری‌های طراحی مشارکت مستقیم دارد، در حالی که در این پروژه نقش LLM محدود و کنترل‌شده است.

این تفاوت‌ها به‌صورت آگاهانه و با هدف آموزشی در نظر گرفته شده‌اند و باعث می‌شوند پروژه حاضر به‌عنوان یک نمونه ساده‌شده و قابل فهم از WiseEDA مطرح شود.

---

## 7. کارهای آینده

سیستم پیاده‌سازی‌شده قابلیت توسعه در جهات مختلفی را دارد. از جمله می‌توان به استفاده گسترده‌تر از LLM برای پیشنهاد توپولوژی‌های جدید، در نظر گرفتن نویز و تلرانس قطعات، پشتیبانی از انواع دیگر فیلترها و مقایسه نتایج با فیلترهای کلاسیک اشاره کرد. همچنین بهبود تابع امتیازدهی برای لحاظ کردن معیارهای عملکردی دیگر مانند فاز و زمان پاسخ‌دهی پله‌ای می‌تواند به افزایش دقت طراحی کمک کند.

---

## 8. نتیجه‌گیری

در این پروژه، یک سیستم طراحی خودکار فیلتر RC پایین‌گذر با الهام از چارچوب WiseEDA ارائه شد. نتایج نشان می‌دهد که حتی برای مدارهای ساده نیز می‌توان از معماری‌های مدرن EDA بهره گرفت و فرآیند طراحی را به‌صورت خودکار و سیستماتیک انجام داد. این پروژه پایه‌ای مناسب برای توسعه‌های آینده و مطالعه عمیق‌تر سیستم‌های طراحی مدار مبتنی بر هوش مصنوعی فراهم می‌کند.

---

## منابع

1. WiseEDA: LLMs in RF Circuit Design
2. Ngspice User Manual
3. Kennedy, J., Eberhart, R., Particle Swarm Optimization
4. Sedra, Smith, Microelectronic Circuits
